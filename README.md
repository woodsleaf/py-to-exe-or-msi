# py-to-exe-or-msi
just scripts for cx-freeze

## Установка виртуального окружения, если надо

Создание окружения `py -3 -m venv .venv`

Разрешение на запуск скриптов в Windows `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope Process`

Активация окружения `.venv\scripts\activate`

Если нужно установка в это окружение необходимых зависимостей.

Деактивация когда больше не требуется `deactivate`

## Установка компилятора `pip install cx_freeze`

## Про скрипты
Третья строка, переменная name, туда впишите имя вашего главного скрипта без расширения, сохраните, 
Запустите как указано во второй строчке скрипта.

Отличия скриптов незначительны

1. exe с поддержкой командной строки
2. exe
3. msi


## Почти Этот вариант

[О cx_Freeze](https://jenyay.net/Programming/Cxfreeze)
Замечено что этим способом сборка происходит быстрее? последним, и как мне показалось с зависимостями.
Особенности: Требует конфигурационный файл, И также в нем описываются необходимые библиотеки.

Требует файла конфигурации `setup.py`
примерно следующего содержания
`# coding: utf-8
from cx_Freeze import setup, Executable
executables = [Executable('example.py')]
setup(name='example', version='0.0.1', description='My Example App!', executables=executables)`

Запуск сборки `python setup.py build`

Вероятно gui сборка требует 64 а не 32 в директиве.
Пример конфигурации параметра executables для сборки нескольких исполняемых файлов в одном пакете.
`executables = [Executable('hello_01.py', targetName='hello_world_01.exe'),
Executable('hello_02.py', targetName='hello_world_02.exe'),
]`


## Другой вариант, ни как не связан с скриптами из репозитария

Для Python выше версии 3.4. Создание исполняемого файла exe из py.

Установить pyinstaller. `pip install pyinstaller` Перейти в папку расположения вашего скрипта, запустить сборку `pyinstaller —onefile имявашегоскрипта.py` После сборки файл окажется в поддиректории dist.

При запуске таким образом собранной программы, под ней запускается еще окно терминала. 

Возможные решения.
Если при сборке добавить ключ `—windowed` запуск будет производиться без дополнительного окна консоли, но к сожалению Касперский тупо вешает проводник при запуске таким образом скомпилированной программы, думаю там свои тонкости.

Чтоб проводник висел недолго, можно собрать проект не в один файл, т.е. убрать параметр `—onefile` , соответственно Антивирус быстрее отпустит маленький экзешник, и сможет проверить все что в него не упаковано отдельно.

